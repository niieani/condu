MVP

- [x] moonrepo integration
- [x] typescript
- [x] typescript references
- [x] scaffolding new packages in monorepo (Create package command)
- [x] GitHub Actions
- [x] automatically add missing workspace dependencies to package.json
- [x] Individual Package overrides
- [x] yarn constraints
- [ ] TS building for release - all files can be in the
  - [ ] make a script to copy all source files into the dist folder, except configs
  - [ ] to get good quality errors, a wild idea would be to just dump the generated .cts files for build, and then remove them after build. maybe this could be done in the memoryFS that's overlaid on top of the real FS, where we use memFS only for the project directory, and the rest is real FS? or better yet, exclude from real FS specifically all the renamed files only. Mocked FS and we just run real `tsc --build` inside of it?
  - [ ] might need to settle for .cjs + .js for now if we want to use tsc --build for default esm build
    - this is also the future, since cjs is going away
  - [ ] for main pass: simply build project with tsc, no changes necessary
  - [ ] for other pass:
    - [x] build as ESM
    - [x] all the in-project references (relative or imports from existing monorepo ids) can be auto renamed to .mts
      - [x] make a list of all files as if imported using package name (e.g. '@thing/package/file.js')
      - [x] for each package, make additionally a list of all files
      - [x] for each file in each package, make a list of possible relative paths for other files (e.g. '../file.js')
      - [x] regexp replace all instances of the above with the '.mjs' extension
      - [x] since the extension is mandatory, failure is very unlikely. even if the filename is common, like './calc.js', it is unlikely this string would be used for anything other than an import from/export from
  - [x] adjust the "sources" in the .map files
  - [x] output will have: .ts, .js, .js.map, .d.ts, .mjs, .d.mts, .mjs.map + all other files
  - [x] solve source map references, still relative to the root, instead of always next to the file
  - [ ] important [thread about this](https://github.com/microsoft/TypeScript/issues/49462)
  - [ ] allow CJS building via SWC
  - [ ] verify that TSX works (typescript doesn't like `const x = <x>() => {}` because it thinks it's a JSX tag, [which is supported in mts/cts by default](https://github.com/microsoft/TypeScript/issues/44442))
- [ ] semantic-release (use [Auto](https://github.com/intuit/auto) instead for mono-repo support)
- [ ] pre-release
  - [ ] copy/generate LICENSE to each package
  - [ ] set correct package.json fields
- [ ] add validation for feature dependencies (e.g. "auto" feature depends on "lerna")
  - maybe not dependencies, but see below - contributed state?
- [ ] add shared state for features (features can contribute to it and build on top of each other's state)
  - perhaps features contribute individual settings, like in vscode - providing a required schema - that way we could validate that the dependent state is valid
- [ ] vitest
- [ ] CI build and test using moon
- [ ] similar tool: https://packemon.dev/
- [ ] vscode auto-ignore generated files

  - use https://www.npmjs.com/package/comment-json to keep the comments and only amend input if it exists

- shippable state -

Later:

- [ ] 2 modes for running TypeScript that you could toggle between - with workspace references, or single-project
  - small projects don't need the overhead/downsides of workspace references
- [ ] when running `apply`, cli should clear previously generated files that are no longer needed
- [ ] should there be 2 default modes for TS? one targetting a more relaxed environment (apps), one targetting more strict ESM?
- [ ] will Deno work with the ESM output out of the box?
- [ ] what if package jsons were also autogenerated? see [bit](https://blog.bitsrc.io/how-to-easily-manage-dependencies-in-a-js-monorepo-6216bd6621ea)
- [ ] jest
- [ ] Customizable package source directory (so we can skip src in mono repo), when publishing copy src into the publish directory. Hmm will semantic publishing work if we copy sources?
- [ ] State file to track changes made to the repo by the tool, and show diff before applying (for upgrading)
- [ ] Migration tool - should remove files from gitignore from committed files
- [ ] Docs: Great collection of [CLI websites](https://news.ycombinator.com/item?id=26878936) on HN
- [ ] TS: add a pure JavaScript with TSDoc mode
- [ ] adding arbitrary github action files from config (which means generating them from code is possible)
- [ ] config file - store local overrides diffing
  - i.e. if you manually change a YAML/JSON config file, we store the diff in .config, and then when we regenerate the config, we apply the diff on top of it
- [ ] move `@repo/core` dependency listing in features to peerDependencies
