# codename: toolchain

- Simple repo management system:

  - Allow custom build strategy
  - Allow overrides for any config
  - Allow search and replace for any config
  - Monorepo support
  - Set build strategy (simple, e.g. library-webpack or web-vite)
  - General repo strategy (Github actions)

- Tools supported:

  - node
  - bun
  - pnpm or yarn?
    - probably yarn (more features, and plugin support)
  - ? deno
  - ? reasonml

- Functionality:

  - setup node/bun version
  - extendable plain files (autogenerated):
    - gitignore, npmignore, etc.
  - typescript
    - auto-project references
  - dummy config strategies (doesn't do anything, but multiple strategies can use the config)
    - target strategy (node/web/react)
    - execution strategy (cli/browser/service/none)
  - dev+build strategies
    - library-types (tsc)
    - library-esm (build + creates esm/package.json with type: "module")
    - library-cjs (build + creates cjs/package.json with type: "commonjs")
    - library-umd (webpack, single file)
    - web-vite
    - app-electron
    - app-react-native (use Ignite? w/ expo)
  - test strategies
    - jest
    - vitest (?)
    - pure node test runner?
    - eslint
  - ci strategies
    - github actions
      - conditionally creates testing + release based on other strategies
  - release strategies
    - semantic-release
    - github pages
  - dependency update automation
    - renovate
    - dependabot
  - ide strategy
    - vscode
      - automatically hide all generated config files from the folder, but create symlinks in .config so they can be previewed in the IDE
  - project website/docs strategy
    - docusaurus
    - storybook

- Config:
  - add custom strategies via .config/scaffold/strategies/... -- could re-export existing ones with custom config

something like:

```ts
import {gitignore, npmignore, editorconfig, license} from '@niieani/scaffold'
export const config: import('@niieani/scaffold').RepoConfig = {
  engine: 'node', // or bun
  engineVersion: '18', // optional
  monorepo: false, // optional
  // infer name, author and license from package.json
  features: [gitignore(), npmignore(), editorconfig(), license()],
}
```

example implementation:

```ts
type FeatureActionFn = (
  config: RepoConfig,
  state: {files: [File]},
) => {files: [File]}

const defineFeature = ({
  actionFn,
  ...config
}: {
  name: string
  actionFn: FeatureActionFn
  /** set the order execution */
  after?: string[]
}) => Object.assign(actionFn, config)

const gitignore = ({ignore}: {ignore?: string[]} = {}) =>
  defineFeature({
    name: 'gitignore',
    actionFn: (config: RepoConfig, state: {files: [File]}) => {
      return {
        files: [
          {
            path: '.gitignore',
            content: ['node_modules', ...ignore].join('\n'),
          },
        ],
      }
    },
  })
```

